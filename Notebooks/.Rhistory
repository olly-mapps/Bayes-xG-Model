plot(cars)
events = read.csv('../Data/events.csv',header=TRUE)
events = read.csv('../Data/events.csv',header=TRUE)
summary(events)
shots <- events[events$event_type == 1, ]
summary(shots)
shots
# Extract observations of shots from the events data
shots_df <- events[events$event_type == 1, ]
# View head of data
shots_df
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
library(dplyr)
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
shots
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
shots.train
#Fit model based on all variables
lm.fit <-  lm(is_goal ~ . , data = shots.train)
#Make predictions using model
lm.pred <-  predict(lm.fit, shots.test)
#Report error
library(dplyr)
library(MASS)
#Fit LDA
lda.fit <-  lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
mean(lda.pred$class != is_goal.test)
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  is_goal[test]
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  shots$is_goal[test]
#Fit LDA
lda.fit <-  lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
mean(lda.pred$class != is_goal.test)
#Convert target to factor
shots$is_goal <- as.factor(shots$is_goal)
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  shots$is_goal[test]
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
mean(lda.pred$class != is_goal.test)
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
#lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
#mean(lda.pred$class != is_goal.test)
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
#lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
#mean(lda.pred$class != is_goal.test)
lda.fit
#Convert variables to factor
shots <- shots %>% mutate_if(is.integer,as.factor)
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  shots$is_goal[test]
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
# Extract observations of shots from the events data
shots_df <- events[events$event_type == 1, ]
# View head of data
shots_df
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
# Extract observations of shots from the events data
shots_df <- events[events$event_type == 1, ]
# View head of data
shots_df
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
#Read in data
events = read.csv('../Data/events.csv',header=TRUE)
#Obtain summary data
summary(events)
# Extract observations of shots from the events data
shots_df <- events[events$event_type == 1, ]
# View head of data
shots_df
#Keep only relevant data
shots <- select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
#Keep only relevant data
shots <- dplyr::select(shots_df, c('shot_place','shot_outcome',
'is_goal','location','bodypart',
'assist_method','situation','fast_break'))
#Convert variables to factor
shots <- shots %>% mutate_if(is.integer,as.factor)
shots
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  shots$is_goal[test]
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
#lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
#mean(lda.pred$class != is_goal.test)
lda.fit
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
mean(lda.pred$class != is_goal.test)
#Fit LDA
lda.fit <- lda(is_goal ~ ., data = shots.train)
#Make predictions based on model
lda.pred <-  predict(lda.fit, shots.test)
#Calculate mis-classification
#mean(lda.pred$class != is_goal.test)
lda.pred
#Fit LDA
glm.fit <- glm(is_goal ~ ., family = "binomial", data = shots.train)
#Make predictions based on model
glm.pred <-  predict(glm.fit, shots.test)
#Calculate mis-classification
mean(glm.pred$class != is_goal.test)
#Fit LDA
glm.fit <- glm(is_goal ~ ., family = "binomial", data = shots.train)
#Calculate mis-classification
glm.probs <-  predict(glm.fit, Auto.test, type = "response")
#Fit LDA
glm.fit <- glm(is_goal ~ ., family = "binomial", data = shots.train)
#Calculate mis-classification
glm.probs <-  predict(glm.fit, shots.test, type = "response")
glm.pred <-  rep(0, length(glm.probs))
glm.pred[glm.probs > 0.5] <- 1
#Fit LDA
glm.fit <- glm(is_goal ~ ., family = "binomial", data = shots.train)
#Calculate mis-classification
glm.probs <-  predict(glm.fit, shots.test, type = "response")
glm.pred <-  rep(0, length(glm.probs))
glm.pred[glm.probs > 0.5] <- 1
mean(glm.pred != is_goal.test)
#Keep only relevant data
shots <- dplyr::select(shots_df, c('is_goal','location','bodypart',
'assist_method','situation','fast_break'))
#Convert variables to factor
shots <- shots %>% mutate_if(is.integer,as.factor)
shots
# Split into test and train subsets
train.size <- nrow(shots) / 2
train <- sample(1:nrow(shots), train.size)
test <- -train
shots.train <- shots[train, ]
shots.test <- shots[test, ]
is_goal.test <-  shots$is_goal[test]
#Fit LDA
glm.fit <- glm(is_goal ~ ., family = "binomial", data = shots.train)
#Calculate mis-classification
glm.probs <-  predict(glm.fit, shots.test, type = "response")
glm.pred <-  rep(0, length(glm.probs))
glm.pred[glm.probs > 0.5] <- 1
mean(glm.pred != is_goal.test)
library(dplyr)
library(MASS)
library(rstanarm)
bmod = stan_glm(is_goal~.,data=shots)
bmod = stan_glm(is_goal~.,data=shots.train)
bmod = stan_glm(is_goal~.,data=shots.train, family = binomial(link = "logit"))
