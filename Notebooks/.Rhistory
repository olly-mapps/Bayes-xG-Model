shots[90:100,]
shots$shortName <- stringi::stri_unescape_unicode(shots$shortName)
hist(shots$angles)
shots <- shots %>% dplyr::filter(shots$angles > 0)
hist(shots$angles)
length(table(shots$playerId))
top_players <- sort(table(shots$playerId), decreasing = T)[1:50]
top_shots <- dplyr::filter(shots, playerId %in% row.names(top_players))
top_shots$bayes_id <- as.numeric(as.factor(top_shots$shortName))
summary(top_shots)
#Defines and distance boxplot
dist_boxplot <- ggplot(top_shots, aes(x=is_goal, y=dist, fill = is_goal)) +
geom_boxplot() +
labs(title="Distributions Of Distances Grouped By Shot Outcome",
x="Shot Outcome",
y="Distance To Goal (m)") +
coord_flip()
dist_boxplot <- dist_boxplot + guides(fill=guide_legend(title="Goal (1) or Not (0)"))
#Defines angles boxplot
angles_boxplot <- ggplot(top_shots, aes(x=is_goal, y=angles, fill = is_goal)) +
geom_boxplot() +
labs(title="Distributions Of Angles Grouped By Shot Outcome",
x="Shot Outcome",
y="Angle To Goal (Degrees)") +
coord_flip()
angles_boxplot <- angles_boxplot + guides(fill=guide_legend(title="Goal (1) or Not (0)"))
#Plots distance boxplot
dist_boxplot
#Plots angles boxplot
angles_boxplot
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "shotVolume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
#Sort in descending order by shot volume
shots_goals <- arrange(shots_goals, desc(shotVolume))
shots_goals$shortName <- shots_goals$shortName %>% as.factor()
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, -value), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
# Split into test and train subsets
train.size <- 0.8 * nrow(top_shots)
train <- sample(1:nrow(top_shots), train.size)
test <- -train
shots.train <- top_shots[train, ]
shots.test <- top_shots[test, ]
is_goal.test <-  top_shots$is_goal[test]
bmod1.5_list <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_list
bmod1.5_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod1.5_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod1.5_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = shots.test[c("dist", "angles")],
beta_mu_1 = 19,
beta_sigma_1 = 10,
beta_mu_2 = 30,
beta_sigma_2 = 10
)
bmod1.5_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod1.5_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod1.5_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod1.5_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_body = 1,
beta_sigma_body = 3
)
bmod1.5 <- stan(file = "../Stan Files/dist+body.stan", data = bmod1.5_list, chains = 1, init = 0, seed = 1)
bmod1.5_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod1.5_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod1.5_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod1.5_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_body = 1,
beta_sigma_body = 3
)
bmod1.5 <- stan(file = "../Stan Files/dist+body.stan", data = bmod1.5_list, chains = 1, init = 0, seed = 1)
bmod1.5_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod1.5_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod1.5_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod1.5_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_body = 0,
beta_sigma_body = 1
)
bmod1.5 <- stan(file = "../Stan Files/dist+body.stan", data = bmod1.5_list, chains = 1, init = 0, seed = 1)
bmod1.5_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod1.5_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod1.5_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod1.5_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod1.5_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_body = 0,
beta_sigma_body = 1
)
bmod1.5 <- stan(file = "../Stan Files/dist+body.stan", data = bmod1.5_list, chains = 4, init = 0, seed = 1)
print(bmod1.5, pars="beta")
plot(bmod1.5, pars="beta")
traceplot(bmod1.5, pars='beta')
ext_fit_1.5 <- extract(bmod1.5)
mean(apply(ext_fit_1.5$y_new, 2, median) == is_goal.test)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p = 2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p = 2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p = 2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p = 2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
print(bmod1, pars="beta")
plot(bmod1, pars="beta")
traceplot(bmod1, pars='beta')
ext_fit_1 <- extract(bmod1)
mean(apply(ext_fit_1$y_new, 2, median) == is_goal.test)
bmod2_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod2_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod2_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod2_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod2_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_body = 0,
beta_sigma_body = 1
)
bmod2 <- stan(file = "../Stan Files/dist+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
print(bmod2, pars="beta")
plot(bmod2, pars="beta")
traceplot(bmod2, pars='beta')
ext_fit_2 <- extract(bmod2)
mean(apply(ext_fit_2$y_new, 2, median) == is_goal.test)
bmod3_X <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.train)
bmod3_X_new <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.test)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10.
)
bmod3 <- stan(file = "../Stan Files/dist+angles.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10.
)
bmod3 <- stan(file = "../Stan Files/dist+angles.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10.
)
bmod3 <- stan(file = "../Stan Files/dist+angles+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10.
)
bmod3 <- stan(file = "../Stan Files/dist+angles+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod3_X <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.train)
bmod3_X_new <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.test)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10
)
bmod3 <- stan(file = "../Stan Files/dist+angles+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10
)
bmod3 <- stan(file = "../Stan Files/dist+angles+body.stan", data = bmod3_list, chains = 4, init = 0, seed = 1)
print(bmod3, pars="beta")
plot(bmod3, pars="beta")
traceplot(bmod3, pars='beta')
ext_fit_3 <- extract(bmod3)
mean(apply(ext_fit_3$y_new, 2, median) == is_goal.test)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
print(bmod1, pars="beta")
plot(bmod1, pars="beta")
traceplot(bmod1, pars='beta')
ext_fit_1 <- extract(bmod1)
mean(apply(ext_fit_1$y_new, 2, median) == is_goal.test)
launch_shinystan(bmod1)
bmod2_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod2_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod2_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod2_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod2_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
)
bmod2_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod2_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod2_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod2_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod2_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10
)
bmod2 <- stan(file = "../Stan Files/dist+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod2_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod2_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod2_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod2_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod2_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10
)
bmod2 <- stan(file = "../Stan Files/dist+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
bmod1_X <- model.matrix(is_goal ~ dist, data = shots.train)
bmod1_X_new <- model.matrix(is_goal ~ dist, data = shots.test)
bmod1_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
p=2,
X = bmod1_X,
n_new = dim(shots.test)[1],
X_new = bmod1_X_new,
beta_mu = 19,
beta_sigma = 10)
bmod1 <- stan(file = "../Stan Files/dist.stan", data = bmod1_list, chains = 4, iter = 1000, init = 0, seed = 1)
print(bmod1, pars="beta")
plot(bmod1, pars="beta")
traceplot(bmod1, pars='beta')
ext_fit_1 <- extract(bmod1)
mean(apply(ext_fit_1$y_new, 2, median) == is_goal.test)
bmod2_X <- model.matrix(is_goal ~ dist + body_part, data = shots.train)
bmod2_X_new <- model.matrix(is_goal ~ dist + body_part, data = shots.test)
bmod2_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod2_X,
p = 4,
n_new = dim(shots.test)[1],
X_new = bmod2_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10
)
bmod2 <- stan(file = "../Stan Files/dist+body.stan", data = bmod2_list, chains = 4, init = 0, seed = 1)
print(bmod2, pars="beta")
plot(bmod2, pars="beta")
traceplot(bmod2, pars='beta')
ext_fit_2 <- extract(bmod2)
mean(apply(ext_fit_2$y_new, 2, median) == is_goal.test)
bmod3_X <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.train)
bmod3_X_new <- model.matrix(is_goal ~ dist + body_part + angles, data = shots.test)
bmod3_list <- list(y = as.numeric(as.character(shots.train$is_goal)),
n = dim(shots.train)[1],
X = bmod3_X,
p = 5,
n_new = dim(shots.test)[1],
X_new = bmod3_X_new,
beta_mu_dist = 19,
beta_sigma_dist = 10,
beta_mu_angle = 30,
beta_sigma_angle = 10
)
bmod3 <- stan(file = "../Stan Files/dist+angles+body.stan", data = bmod3_list, chains = 4, init = 0, seed = 1)
print(bmod3, pars="beta")
plot(bmod3, pars="beta")
traceplot(bmod3, pars='beta')
ext_fit_3 <- extract(bmod3)
mean(apply(ext_fit_3$y_new, 2, median) == is_goal.test)
plot(density(ext_fit$pp_y_new))
lines(density(ext_fit$salah_y_new))
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- melt(salah_pp)
salah_pp
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- reshape2::melt(salah_pp)
salah_pp
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- reshape2::melt(salah_pp)
salah_pp_plot <- ggplot(salah_pp, aes(x=value, fill=variable)) +
geom_density(alpha=.25)
salah_pp <- data.frame(ext_fit$pp_y_new, ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- reshape2::melt(salah_pp)
salah_pp_plot <- ggplot(salah_pp, aes(x=value, fill=variable)) +
geom_density(alpha=.25)
salah_pp_plot
salah_pp <- data.frame(population = ext_fit$pp_y_new, Mohamed Salah = ext_fit$salah_y_new)
salah_pp <- data.frame(population = ext_fit$pp_y_new, MohamedSalah = ext_fit$salah_y_new)
#salah_pp <- melt(salah_pp)
#salah_pp_plot <- ggplot(salah_pp, aes(x=weight)) +
#  geom_density()
salah_pp <- reshape2::melt(salah_pp)
salah_pp_plot <- ggplot(salah_pp, aes(x=value, fill=variable)) +
geom_density(alpha=.25) +
labs(title="xG Plot Of The Population And Mohamed Salah",
x="xG",
y="Likelihood")
salah_pp_plot <- salah_pp_plot + guides(fill=guide_legend(title=""))
salah_pp_plot
salah_pp <- data.frame(Population = ext_fit$pp_y_new, MohamedSalah = ext_fit$salah_y_new)
salah_pp <- reshape2::melt(salah_pp)
salah_pp_plot <- ggplot(salah_pp, aes(x=value, fill=variable)) +
geom_density(alpha=.25) +
labs(title="xG Plot Of The Population And Mohamed Salah",
x="xG",
y="Likelihood")
salah_pp_plot <- salah_pp_plot + guides(fill=guide_legend(title="Key"))
salah_pp_plot
