#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "Shot Volume"
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
distinct(summed_goals, shortName)
#top_players_df <- merge(top_players_df, top_shots, by = "playerId")
#top_players_df <- top_players_df %>% dplyr::select(c("playerId", "shortName", "Freq", "is_goal"))
#top_players_df$is_goal <- as.numeric(as.character(top_players_df$is_goal))
#top_players_df
#summed_goals <- top_players_df %>%
#  group_by(shortName) %>%
#  summarise(goals = sum(is_goal))
#summed_goals
#shots_goals <- summed_goals %>%
#  mutate(freq = top_players_df[which(top_players_df$shortName == summed_goals$shortName)[1], "Freq"])
#top_players_df[which(top_players_df$shortName == "Suso")[1], "Freq"]
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "Shot Volume"
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
distinct(summed_goals)
#top_players_df <- merge(top_players_df, top_shots, by = "playerId")
#top_players_df <- top_players_df %>% dplyr::select(c("playerId", "shortName", "Freq", "is_goal"))
#top_players_df$is_goal <- as.numeric(as.character(top_players_df$is_goal))
#top_players_df
#summed_goals <- top_players_df %>%
#  group_by(shortName) %>%
#  summarise(goals = sum(is_goal))
#summed_goals
#shots_goals <- summed_goals %>%
#  mutate(freq = top_players_df[which(top_players_df$shortName == summed_goals$shortName)[1], "Freq"])
#top_players_df[which(top_players_df$shortName == "Suso")[1], "Freq"]
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "Shot Volume"
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
shots_goals
#top_players_df <- merge(top_players_df, top_shots, by = "playerId")
#top_players_df <- top_players_df %>% dplyr::select(c("playerId", "shortName", "Freq", "is_goal"))
#top_players_df$is_goal <- as.numeric(as.character(top_players_df$is_goal))
#top_players_df
#summed_goals <- top_players_df %>%
#  group_by(shortName) %>%
#  summarise(goals = sum(is_goal))
#summed_goals
#shots_goals <- summed_goals %>%
#  mutate(freq = top_players_df[which(top_players_df$shortName == summed_goals$shortName)[1], "Freq"])
#top_players_df[which(top_players_df$shortName == "Suso")[1], "Freq"]
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "Shot Volume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
shots_goals <- arrange(shots_goals, desc(goals))
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "Shot Volume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
shots_goals <- arrange(shots_goals, desc(goals))
shots_goals
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "shotVolume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
#Sort in descending order by shot volume
shots_goals <- arrange(shots_goals, desc(shotVolume))
shots_goals
shots_goals_plot <- ggplot(mtcars, aes(x=shotVolume, fill = goals))+
geom_bar(stat="count")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = goals))+
geom_bar(stat="count")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = goals))+
geom_bar(stat="identity", position = dodge)
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = goals))+
geom_bar(stat="identity")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = goals))+
geom_bar(stat="bin")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = shortName))+
geom_bar(stat="bin")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shotVolume, fill = shortName))+
geom_bar(stat="count")
shots_goals_plot
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "shotVolume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
#Sort in descending order by shot volume
shots_goals <- arrange(shots_goals, desc(shotVolume))
shots_goals <- shots_goals %>% as.factor()
shots_goals
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "shotVolume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
#Sort in descending order by shot volume
shots_goals <- arrange(shots_goals, desc(shotVolume))
shots_goals$shortName <- shots_goals$shortName %>% as.factor()
shots_goals
shots_goals_plot <- ggplot(shots_goals, aes(x=shortName, y = shotVolume))+
geom_bar(stat="count")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shortName, y = shotVolume))+
geom_bar(stat="identity")
shots_goals_plot
shots_goals_plot <- ggplot(shots_goals, aes(x=shortName, y = shotVolume, fill = goals))+
geom_bar(stat="identity")
shots_goals_plot
shots_goals_long = gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity")
shots_goals_plot
shots_goals_long = gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity")
shots_goals_plot
shots_goals_long = gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'dodge')
shots_goals_plot
shots_goals_long = gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity')
shots_goals_plot
shots_goals_long = gather(shots_goals, key = Key, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume")
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume")
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume")
shots_goals_plot <- shots_goal_plot + guides(fill=guide_legend(title="Key"))
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume")
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 90))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
#Create data-frame from top_players table defined earlier
top_players_df <- data.frame(top_players)
#Rename columns
colnames(top_players_df)[colnames(top_players_df) == "Var1"] <- "playerId"
colnames(top_players_df)[colnames(top_players_df) == "Freq"] <- "shotVolume"
#We add a column containing player name
top_players_df <- merge(top_players_df, distinct(top_shots[, c("playerId", "shortName")]), by = "playerId")
#We create a dataframe where the is_goal variable is numeric
numeric_goals <- top_shots[, c("shortName", "is_goal")]
numeric_goals$is_goal <- as.numeric(as.character(numeric_goals$is_goal))
#We sum up goals scored by player
summed_goals <- numeric_goals %>%
group_by(shortName) %>%
summarise(goals = sum(is_goal))
#Merge to final data-frame
shots_goals <- merge(top_players_df, summed_goals, by = "shortName")
#Sort in descending order by shot volume
shots_goals <- arrange(shots_goals, desc(shotVolume))
shots_goals$shortName <- shots_goals$shortName %>% as.factor()
shots_goals
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity') +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 2) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 0.5) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_bar(stat="identity", position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(stat="identity", position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = 'identity', width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = 'identity', width = 0.9, position_dodge(width = 0.5)) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = position_dodge(width = 0.5), width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(width = 0.9) +
theme(aspect.ratio = 3/5) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
theme(aspect.ratio = 3/5) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = "identity", width = 0.7) +
theme(aspect.ratio = 3/5) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = "identity", width = 0.7) +
theme(aspect.ratio = 3/5) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=shortName, y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName,shortName,
function(x)-length(x))),
y = value, fill = var) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, -shotVolume), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, -shots_goals$shotVolume), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
value
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long$value
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, shotVolume), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, shots_goals_long$value), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, -value), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long
shots_goals_plot <- ggplot(shots_goals_long, aes(
x=reorder(shortName, shots_goals_long[shots_goals_long$var == "shotVolume", c("value")],
y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long
shots_goals_plot <- ggplot(shots_goals_long, aes(
x=reorder(shortName, shots_goals_long[shots_goals_long$var == "shotVolume", c("value")],
y = value, fill = var))) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
shots_goals_long <- gather(shots_goals, key = var, value = value, shotVolume, goals)
shots_goals_long
shots_goals_plot <- ggplot(shots_goals_long, aes(x=reorder(shortName, -value), y = value, fill = var)) +
geom_col(position = "identity", width = 0.9) +
labs(title="Shots And Goals By Player",
x="Players",
y="Volume") +
scale_x_discrete(guide = guide_axis(angle = 60))
shots_goals_plot <- shots_goals_plot + guides(fill=guide_legend(title="Key"))
shots_goals_plot
# Split into test and train subsets
train.size <- 0.8 * nrow(top_shots)
train <- sample(1:nrow(top_shots), train.size)
test <- -train
shots.train <- top_shots[train, ]
shots.test <- top_shots[test, ]
is_goal.test <-  top_shots$is_goal[test]
